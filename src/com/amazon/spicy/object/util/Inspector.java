package com.amazon.spicy.object.util;

import java.lang.reflect.Field;
import java.lang.reflect.Modifier;
import java.math.BigDecimal;
import java.math.BigInteger;
import java.nio.ByteBuffer;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Date;
import java.util.HashSet;
import java.util.List;
import java.util.Set;

public abstract class Inspector {

    private static final Set<Class<?>> EXPLICIT_PRIMITIVES = new HashSet<Class<?>>();

    static {
        EXPLICIT_PRIMITIVES.addAll(Arrays.asList(boolean.class, Boolean.class,
                                                 byte.class, Byte.class,
                                                 char.class, Character.class,
                                                 short.class, Short.class,
                                                 int.class, Integer.class,
                                                 long.class, Long.class,
                                                 float.class, Float.class,
                                                 double.class, Double.class,
                                                 String.class,
                                                 ByteBuffer.class,
                                                 BigDecimal.class,
                                                 BigInteger.class,
                                                 Date.class,
                                                 Object.class
        ));
    }

    public static boolean isExplicitPrimitive(Class<?> clazz) {
        return EXPLICIT_PRIMITIVES.contains(clazz);
    }

    public static boolean isAbstract(Class<?> clazz) {
        return Modifier.isAbstract(clazz.getModifiers());
    }

    public static boolean isInterface(Class<?> clazz) {
        return Modifier.isInterface(clazz.getModifiers());
    }

    public static boolean isStatic(Field field) {
        return Modifier.isStatic(field.getModifiers());
    }

    public static boolean isTransient(Field field) {
        return Modifier.isTransient(field.getModifiers());
    }

    public static boolean isVolatile(Field field) {
        return Modifier.isVolatile(field.getModifiers());
    }

    public static boolean isFinal(Field field) {
        return Modifier.isFinal(field.getModifiers());
    }

    /**
     * Get all fields of a class, including fields defined in super class.
     *
     * @param clazz class to find
     * @return all fields found
     */
    public static List<Field> getFields(Class<?> clazz) {
        List<Field> fields = new ArrayList<>();
        while (clazz != Object.class) {
            fields.addAll(Arrays.asList(clazz.getDeclaredFields()));
            clazz = clazz.getSuperclass();
        }
        return fields;
    }

}
